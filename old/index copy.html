<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Platform Investment Calculator</title>
    
    <!-- Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/tippy.css">
    
    <!-- Export Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Styles -->
    <style type="text/tailwindcss">
        @layer components {
            .slider {
                @apply w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer;
            }
            
            .slider::-webkit-slider-thumb {
                @apply appearance-none w-4 h-4 bg-indigo-600 rounded-full cursor-pointer;
            }
            
            .input-number {
                @apply w-24 px-3 py-2 text-gray-700 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-600;
            }
            
            .chart-container {
                @apply bg-white p-4 rounded-xl shadow-lg mb-6 h-[250px];
            }
            
            .card {
                @apply bg-white rounded-xl shadow-lg p-6;
            }
            
            .btn {
                @apply px-4 py-2 rounded-lg font-medium transition-all duration-200;
            }
            
            .btn-primary {
                @apply bg-indigo-600 text-white hover:bg-indigo-700;
            }
            
            .btn-secondary {
                @apply bg-white text-gray-700 hover:bg-gray-50 border border-gray-200;
            }

            .input-group {
                @apply space-y-2;
            }

            .input-label {
                @apply text-sm font-medium text-gray-700 flex items-center;
            }

            .tooltip {
                @apply ml-2 text-gray-400 hover:text-gray-600 cursor-help;
            }

            .export-btn {
                @apply px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200
                       flex items-center gap-2 border border-gray-200;
            }
            
            .export-btn-primary {
                @apply bg-indigo-600 text-white hover:bg-indigo-700 border-transparent;
            }
            
            .export-btn-secondary {
                @apply bg-white text-gray-700 hover:bg-gray-50;
            }

            .chart-tabs {
                @apply flex gap-2 mb-4;
            }

            .chart-tab {
                @apply px-3 py-1.5 text-sm font-medium rounded-lg transition-all duration-200
                       border border-gray-200 cursor-pointer;
            }

            .chart-tab.active {
                @apply bg-indigo-600 text-white border-transparent;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        // Constants
        const MONTHLY_WORKING_HOURS = 160;

        // Input Components
        const InputWithSlider = ({ label, name, min, max, step, value, onChange, tooltip }) => (
            <div className="input-group">
                <label className="input-label">
                    {label}
                    {tooltip && (
                        <span className="tooltip" data-tippy-content={tooltip}>
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                    d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </span>
                    )}
                </label>
                <div className="flex items-center gap-4">
                    <input
                        type="range"
                        name={name}
                        min={min}
                        max={max}
                        step={step}
                        value={value}
                        onChange={onChange}
                        className="slider"
                    />
                    <input
                        type="number"
                        name={name}
                        value={value}
                        onChange={onChange}
                        onFocus={(e) => e.target.select()}
                        className="input-number"
                    />
                </div>
            </div>
        );

        const ModelSelector = ({ activeModel, setActiveModel }) => (
            <div className="space-y-6">
                <div className="flex justify-center gap-4 mb-8">
                    {[
                        { 
                            id: 'team', 
                            label: 'Team Based',
                            icon: (
                                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            ),
                            description: 'Perfect for organizations with an existing service team. Calculate potential savings by automating manual tasks and improving team efficiency through a platform solution.',
                            features: [
                                'Based on team size and hourly rates',
                                'Considers service delivery efficiency',
                                'Accounts for automation benefits'
                            ]
                        },
                        { 
                            id: 'ticket', 
                            label: 'Ticket Based',
                            icon: (
                                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                                </svg>
                            ),
                            description: 'Ideal for help desk and support teams handling service requests. Analyze cost savings based on automating ticket handling and reducing resolution times.',
                            features: [
                                'Based on monthly ticket volume',
                                'Considers resolution time improvements',
                                'Accounts for automation potential'
                            ]
                        },
                        { 
                            id: 'outsource', 
                            label: 'Outsourcing',
                            icon: (
                                <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            ),
                            description: 'Compare costs between external service providers and platform automation. Evaluate the full financial impact including transition costs.',
                            features: [
                                'Includes vendor rates and overhead',
                                'Considers transition costs',
                                'Accounts for management time'
                            ]
                        }
                    ].map(model => (
                        <div key={model.id} className="w-full max-w-sm">
                            <button
                                onClick={() => setActiveModel(model.id)}
                                className={`w-full p-6 rounded-xl transition-all duration-200 ${
                                    activeModel === model.id 
                                    ? 'bg-indigo-600 text-white shadow-lg transform scale-105' 
                                    : 'bg-white text-gray-700 hover:bg-gray-50 border border-gray-200'
                                }`}
                            >
                                <div className="flex items-center justify-center mb-4">
                                    <div className={`p-3 rounded-full ${
                                        activeModel === model.id ? 'bg-indigo-500' : 'bg-indigo-100'
                                    }`}>
                                        {model.icon}
                                    </div>
                                </div>
                                <h3 className="text-lg font-semibold mb-2">{model.label}</h3>
                                <p className={`text-sm mb-4 ${
                                    activeModel === model.id ? 'text-indigo-100' : 'text-gray-600'
                                }`}>
                                    {model.description}
                                </p>
                                <div className={`text-sm ${
                                    activeModel === model.id ? 'text-indigo-200' : 'text-gray-500'
                                }`}>
                                    <ul className="space-y-2">
                                        {model.features.map((feature, index) => (
                                            <li key={index} className="flex items-center gap-2">
                                                <svg className="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                                </svg>
                                                {feature}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            </button>
                        </div>
                    ))}
                </div>
            </div>
        );

        const TeamInputs = ({ inputs, handleInputChange }) => (
            <div className="space-y-6">
                <div className="bg-blue-50 p-4 rounded-lg mb-6">
                    <h4 className="text-blue-800 font-medium mb-2">How to use this calculator:</h4>
                    <ul className="text-blue-700 text-sm space-y-2">
                        <li>1. Enter your current team size and average hourly rate</li>
                        <li>2. Estimate the percentage of time spent on service delivery</li>
                        <li>3. Adjust platform costs and expected efficiency improvements</li>
                        <li>4. Review the analysis results and ROI projections</li>
                    </ul>
                </div>
                <InputWithSlider
                    label="Team Size (FTEs)"
                    name="teamSize"
                    min={1}
                    max={50}
                    step={1}
                    value={inputs.teamSize}
                    onChange={handleInputChange}
                    tooltip="Number of full-time employees currently involved in service delivery. This includes all team members who contribute to the service process."
                />
                <InputWithSlider
                    label="Hourly Rate ($)"
                    name="hourlyRate"
                    min={50}
                    max={200}
                    step={10}
                    value={inputs.hourlyRate}
                    onChange={handleInputChange}
                    tooltip="Average hourly cost per team member, including salary, benefits, and overhead costs. This helps calculate the true cost of service delivery."
                />
                <InputWithSlider
                    label="Service Delivery Time (%)"
                    name="serviceDeliveryPercent"
                    min={0}
                    max={100}
                    step={5}
                    value={inputs.serviceDeliveryPercent}
                    onChange={handleInputChange}
                    tooltip="Percentage of work hours spent directly on service delivery tasks. This helps identify the potential for automation and efficiency improvements."
                />
            </div>
        );

        const TicketInputs = ({ inputs, handleInputChange }) => (
            <div className="space-y-6">
                <div className="bg-blue-50 p-4 rounded-lg mb-6">
                    <h4 className="text-blue-800 font-medium mb-2">How to use this calculator:</h4>
                    <ul className="text-blue-700 text-sm space-y-2">
                        <li>1. Enter your average monthly ticket volume</li>
                        <li>2. Estimate time spent per ticket and team size</li>
                        <li>3. Adjust platform costs and automation potential</li>
                        <li>4. Review potential savings and ROI analysis</li>
                    </ul>
                </div>
                <InputWithSlider
                    label="Tickets per Month"
                    name="ticketsPerMonth"
                    min={1}
                    max={100}
                    step={1}
                    value={inputs.ticketsPerMonth}
                    onChange={handleInputChange}
                    tooltip="Average number of service tickets handled monthly. This helps understand your current workload and automation potential."
                />
                <InputWithSlider
                    label="Hours per Ticket"
                    name="hoursPerTicket"
                    min={1}
                    max={40}
                    step={1}
                    value={inputs.hoursPerTicket}
                    onChange={handleInputChange}
                    tooltip="Average time spent resolving each ticket. This includes all activities from initial response to final resolution."
                />
                <InputWithSlider
                    label="People per Ticket"
                    name="peoplePerTicket"
                    min={1}
                    max={5}
                    step={1}
                    value={inputs.peoplePerTicket}
                    onChange={handleInputChange}
                    tooltip="Average number of team members involved in handling each ticket. This helps calculate the total human resource cost per ticket."
                />
            </div>
        );

        const OutsourceInputs = ({ inputs, handleInputChange }) => (
            <div className="space-y-6">
                <div className="bg-blue-50 p-4 rounded-lg mb-6">
                    <h4 className="text-blue-800 font-medium mb-2">How to use this calculator:</h4>
                    <ul className="text-blue-700 text-sm space-y-2">
                        <li>1. Enter the vendor's hourly rate and estimated hours</li>
                        <li>2. Include one-time transition costs</li>
                        <li>3. Consider management overhead percentage</li>
                        <li>4. Compare total costs with platform solution</li>
                    </ul>
                </div>
                <InputWithSlider
                    label="Vendor Hourly Rate ($)"
                    name="vendorRate"
                    min={20}
                    max={150}
                    step={5}
                    value={inputs.vendorRate}
                    onChange={handleInputChange}
                    tooltip="Hourly rate charged by the outsourcing vendor. This should include all direct service delivery costs."
                />
                <InputWithSlider
                    label="Monthly Hours"
                    name="monthlyHours"
                    min={40}
                    max={1000}
                    step={20}
                    value={inputs.monthlyHours}
                    onChange={handleInputChange}
                    tooltip="Estimated monthly service hours required from the vendor. This helps calculate the total monthly outsourcing cost."
                />
                <InputWithSlider
                    label="Transition Cost ($)"
                    name="transitionCost"
                    min={10000}
                    max={200000}
                    step={10000}
                    value={inputs.transitionCost}
                    onChange={handleInputChange}
                    tooltip="One-time cost for transitioning to the outsourced service. This includes knowledge transfer, documentation, and training."
                />
                <InputWithSlider
                    label="Management Overhead (%)"
                    name="managementOverhead"
                    min={5}
                    max={30}
                    step={5}
                    value={inputs.managementOverhead}
                    onChange={handleInputChange}
                    tooltip="Additional management time and resources needed to oversee the outsourced service, expressed as a percentage of the base cost."
                />
            </div>
        );

        const PlatformInputs = ({ inputs, handleInputChange }) => (
            <div className="space-y-6 mt-8 pt-8 border-t border-gray-200">
                <div className="bg-indigo-50 p-4 rounded-lg mb-6">
                    <h4 className="text-indigo-800 font-medium mb-2">Platform Investment Details</h4>
                    <p className="text-indigo-700 text-sm">
                        These settings help calculate the return on investment (ROI) for implementing a 
                        platform solution. Consider both initial costs and ongoing expenses, as well as 
                        expected efficiency improvements.
                    </p>
                </div>
                <InputWithSlider
                    label="Platform Development Cost ($)"
                    name="platformCost"
                    min={50000}
                    max={500000}
                    step={10000}
                    value={inputs.platformCost}
                    onChange={handleInputChange}
                    tooltip="Total investment required to develop and implement the platform solution. Include development, testing, and deployment costs."
                />
                <InputWithSlider
                    label="Monthly Maintenance Cost ($)"
                    name="platformMaintenanceCost"
                    min={1000}
                    max={20000}
                    step={1000}
                    value={inputs.platformMaintenanceCost}
                    onChange={handleInputChange}
                    tooltip="Ongoing monthly costs to maintain and support the platform. This includes hosting, updates, and technical support."
                />
                <InputWithSlider
                    label="Expected Reduction (%)"
                    name="expectedReduction"
                    min={0}
                    max={100}
                    step={5}
                    value={inputs.expectedReduction}
                    onChange={handleInputChange}
                    tooltip="Expected percentage reduction in manual service work after implementing the platform. This represents the efficiency gain from automation."
                />
                <InputWithSlider
                    label="Build Time (months)"
                    name="buildTime"
                    min={1}
                    max={24}
                    step={1}
                    value={inputs.buildTime}
                    onChange={handleInputChange}
                    tooltip="Estimated time needed to build and fully deploy the platform. This affects when you'll start seeing benefits from the investment."
                />
            </div>
        );

        const MetricCard = ({ title, value, trend, color = 'indigo' }) => (
            <div className={`bg-${color}-50 p-4 rounded-xl border border-${color}-200`}>
                <h3 className="text-sm font-medium text-gray-600">{title}</h3>
                <div className="mt-2 flex items-baseline gap-2">
                    <span className="text-2xl font-bold text-gray-900">
                        {typeof value === 'number' ? `$${value.toLocaleString()}` : value}
                    </span>
                    {trend && (
                        <span className={`text-sm font-medium text-${color}-600`}>
                            {trend}
                        </span>
                    )}
                </div>
            </div>
        );

        const ExportButtons = ({ onExportPDF, onExportExcel }) => (
            <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 className="text-lg font-semibold text-gray-900 mb-4">Export Analysis</h3>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button 
                        onClick={onExportPDF}
                        className="flex items-center justify-center gap-3 px-6 py-4 bg-indigo-600 text-white rounded-xl
                                 hover:bg-indigo-700 transition-all duration-200 shadow-md hover:shadow-lg"
                    >
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <div className="text-left">
                            <div className="font-semibold">Export as PDF</div>
                            <div className="text-sm text-indigo-200">Detailed report with visualizations</div>
                        </div>
                    </button>
                    <button 
                        onClick={onExportExcel}
                        className="flex items-center justify-center gap-3 px-6 py-4 bg-emerald-600 text-white rounded-xl
                                 hover:bg-emerald-700 transition-all duration-200 shadow-md hover:shadow-lg"
                    >
                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                        <div className="text-left">
                            <div className="font-semibold">Export to Excel</div>
                            <div className="text-sm text-emerald-200">Raw data for further analysis</div>
                        </div>
                    </button>
                </div>
            </div>
        );

        const ChartTabs = ({ activeChart, setActiveChart }) => (
            <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 className="text-lg font-semibold text-gray-900 mb-4">Analysis Views</h3>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                    {[
                        { 
                            id: 'cumulative', 
                            label: 'Total Cost Over Time',
                            description: 'Compare cumulative costs between approaches'
                        },
                        { 
                            id: 'monthly', 
                            label: 'Monthly Expenses',
                            description: 'View month-by-month cost comparison'
                        },
                        { 
                            id: 'breakdown', 
                            label: 'Cost Distribution',
                            description: 'See how costs are distributed'
                        },
                        { 
                            id: 'savings', 
                            label: 'Savings Analysis',
                            description: 'Track potential savings over time'
                        }
                    ].map(tab => (
                        <button
                            key={tab.id}
                            onClick={() => setActiveChart(tab.id)}
                            className={`p-4 rounded-xl text-left transition-all duration-200 ${
                                activeChart === tab.id 
                                ? 'bg-indigo-600 text-white' 
                                : 'bg-gray-50 text-gray-700 hover:bg-gray-100'
                            }`}
                        >
                            <div className="font-medium mb-1">{tab.label}</div>
                            <div className={`text-sm ${
                                activeChart === tab.id ? 'text-indigo-100' : 'text-gray-500'
                            }`}>
                                {tab.description}
                            </div>
                        </button>
                    ))}
                </div>
            </div>
        );

        const ComparisonTable = ({ calculations }) => (
            <div className="bg-white rounded-xl shadow-lg p-6 overflow-hidden">
                <h3 className="text-lg font-semibold text-gray-900 mb-4">Cost Comparison</h3>
                <div className="overflow-x-auto">
                    <table className="min-w-full divide-y divide-gray-200">
                        <thead className="bg-gray-50">
                            <tr>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Time Period
                                </th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Current Approach
                                </th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Platform Approach
                                </th>
                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Potential Savings
                                </th>
                            </tr>
                        </thead>
                        <tbody className="bg-white divide-y divide-gray-200">
                            <tr>
                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                    Monthly
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${calculations.currentMonthlyCost.toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${calculations.platformMonthlyCost.toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm">
                                    <span className={`px-2 py-1 rounded-full ${
                                        calculations.platformMonthlyCost < calculations.currentMonthlyCost 
                                        ? 'bg-emerald-100 text-emerald-800' 
                                        : 'bg-red-100 text-red-800'
                                    }`}>
                                        ${Math.abs(calculations.currentMonthlyCost - calculations.platformMonthlyCost).toLocaleString()}
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                    First Year
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${(calculations.currentMonthlyCost * 12).toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${(calculations.platformMonthlyCost * 12).toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm">
                                    <span className={`px-2 py-1 rounded-full ${
                                        calculations.platformMonthlyCost < calculations.currentMonthlyCost 
                                        ? 'bg-emerald-100 text-emerald-800' 
                                        : 'bg-red-100 text-red-800'
                                    }`}>
                                        ${Math.abs(calculations.currentMonthlyCost * 12 - calculations.platformMonthlyCost * 12).toLocaleString()}
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                    Three Years
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${calculations.currentCosts[35].toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    ${calculations.platformCosts[35].toLocaleString()}
                                </td>
                                <td className="px-6 py-4 whitespace-nowrap text-sm">
                                    <span className="px-2 py-1 rounded-full bg-emerald-100 text-emerald-800">
                                        ${calculations.threeYearSavings.toLocaleString()}
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div className="mt-6 p-4 bg-gray-50 rounded-lg">
                    <h4 className="font-medium text-gray-900 mb-2">Key Insights</h4>
                    <ul className="space-y-2 text-sm text-gray-600">
                        <li className="flex items-start gap-2">
                            <svg className="w-5 h-5 text-indigo-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Break-even Point: {typeof calculations.breakEvenMonths === 'number' ? 
                                `${calculations.breakEvenMonths} months` : calculations.breakEvenMonths}
                        </li>
                        <li className="flex items-start gap-2">
                            <svg className="w-5 h-5 text-indigo-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Total ROI: {calculations.savingsPercent}%
                        </li>
                        <li className="flex items-start gap-2">
                            <svg className="w-5 h-5 text-indigo-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            Monthly Savings: ${Math.abs(calculations.currentMonthlyCost - calculations.platformMonthlyCost).toLocaleString()}
                        </li>
                    </ul>
                </div>
            </div>
        );

        const AnalysisResults = ({ activeModel, calculations }) => {
            const [activeChart, setActiveChart] = React.useState('cumulative');
            const chartRef = React.useRef(null);
            const chartInstance = React.useRef(null);

            const handleExportPDF = () => {
                const doc = new jspdf.jsPDF();
                
                // Helper function for safe number formatting
                const safeFormat = (number) => {
                    return (number || 0).toLocaleString();
                };
                
                // Add professional header with logo
                doc.setFillColor(79, 70, 229);
                doc.rect(0, 0, 220, 50, 'F');
                
                // Title and subtitle
                doc.setTextColor(255);
                doc.setFontSize(28);
                doc.setFont('helvetica', 'bold');
                doc.text('Investment Analysis Report', 20, 30);
                
                doc.setFontSize(12);
                doc.setFont('helvetica', 'normal');
                doc.text(`Generated on ${new Date().toLocaleDateString()}`, 20, 42);
                
                // Executive Summary
                let y = 70;
                doc.setTextColor(0);
                doc.setFontSize(20);
                doc.setFont('helvetica', 'bold');
                doc.text('Executive Summary', 20, y);
                
                y += 15;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                const summaryText = `This comprehensive analysis evaluates the financial implications of transitioning from current operations to a platform-based solution. The report covers a three-year period and includes detailed cost analysis, risk assessment, and ROI projections.`;
                const wrappedSummary = splitText(summaryText, 11, 170);
                doc.text(wrappedSummary, 20, y);
                
                // Key Financial Metrics
                y += wrappedSummary.length * 7 + 20;
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.text('Key Financial Metrics', 20, y);
                
                y += 10;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                
                // Create metrics table with colored backgrounds
                const metrics = [
                    ['Current Monthly Cost:', `$${safeFormat(calculations.currentMonthlyCost)}`],
                    ['Platform Monthly Cost:', `$${safeFormat(calculations.platformMonthlyCost)}`],
                    ['Break-even Point:', typeof calculations.breakEvenMonths === 'number' ? 
                        `${calculations.breakEvenMonths} months` : 'Not calculated'],
                    ['3-Year Total Savings:', `$${safeFormat(calculations.threeYearSavings)}`],
                    ['Return on Investment:', `${safeFormat(calculations.savingsPercent)}%`]
                ];
                
                metrics.forEach(([label, value], index) => {
                    // Add alternating row backgrounds
                    if (index % 2 === 0) {
                        doc.setFillColor(247, 248, 250);
                        doc.rect(20, y - 5, 170, 10, 'F');
                    }
                    
                    doc.setFont('helvetica', 'bold');
                    doc.text(label, 25, y);
                    doc.setFont('helvetica', 'normal');
                    doc.text(value, 120, y);
                    y += 12;
                });
                
                // Add charts
                y += 20;
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.text('Cost Analysis Visualization', 20, y);
                
                y += 10;
                const canvas = chartRef.current;
                const imgData = canvas.toDataURL('image/png');
                doc.addImage(imgData, 'PNG', 20, y, 170, 100);
                
                // Add new page for detailed analysis
                doc.addPage();
                
                // Detailed Analysis Header
                doc.setFillColor(79, 70, 229);
                doc.rect(0, 0, 220, 20, 'F');
                doc.setTextColor(255);
                doc.setFontSize(16);
                doc.text('Detailed Analysis', 20, 15);
                
                // Reset text color
                doc.setTextColor(0);
                y = 40;
                
                // Cost Breakdown
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('Cost Breakdown Analysis', 20, y);
                
                y += 15;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                
                const costBreakdown = [
                    ['Development Costs:', `$${safeFormat(calculations.platformCost)}`],
                    ['Monthly Maintenance:', `$${safeFormat(calculations.platformMaintenanceCost)}`],
                    ['Operational Costs (Monthly):', `$${safeFormat(calculations.platformMonthlyCost)}`]
                ];
                
                costBreakdown.forEach(([label, value]) => {
                    doc.text(`${label} ${value}`, 25, y);
                    y += 10;
                });
                
                // Risk Analysis
                y += 20;
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('Risk Analysis', 20, y);
                
                y += 15;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                
                const riskAnalysis = [
                    ['Optimistic Scenario:', `$${safeFormat(calculations.optimisticSavings)} savings`],
                    ['Expected Scenario:', `$${safeFormat(calculations.threeYearSavings)} savings`],
                    ['Pessimistic Scenario:', `$${safeFormat(calculations.pessimisticSavings)} savings`]
                ];
                
                riskAnalysis.forEach(([label, value]) => {
                    doc.text(`${label} ${value}`, 25, y);
                    y += 10;
                });
                
                // Recommendations
                y += 20;
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('Recommendations', 20, y);
                
                y += 15;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                
                const recommendations = [
                    'Consider phased implementation to validate assumptions and minimize risk',
                    'Monitor key performance indicators during transition',
                    'Establish clear success criteria and measurement frameworks',
                    'Invest in team training and change management'
                ];
                
                recommendations.forEach(rec => {
                    doc.circle(25, y - 3, 1, 'F');
                    const wrappedRec = splitText(rec, 11, 160);
                    doc.text(wrappedRec, 30, y);
                    y += wrappedRec.length * 7 + 5;
                });
                
                // Footer
                doc.setFontSize(8);
                doc.setTextColor(128);
                doc.text('Generated by Service Platform Investment Calculator', 20, 280);
                doc.text(new Date().toLocaleString(), 160, 280);
                
                // Save the PDF
                doc.save('investment-analysis-report.pdf');
            };

            const handleExportExcel = () => {
                const wb = XLSX.utils.book_new();
                
                // Helper function for safe number formatting
                const safeFormat = (number) => {
                    return number || 0;
                };
                
                // Create monthly data worksheet
                const monthlyData = (calculations.months || []).map((month, index) => ({
                    Month: month,
                    'Current Cost': safeFormat(calculations.currentCosts?.[index]),
                    'Platform Cost': safeFormat(calculations.platformCosts?.[index]),
                    'Monthly Savings': safeFormat(calculations.currentCosts?.[index] - calculations.platformCosts?.[index])
                }));
                
                // Create summary worksheet
                const summaryData = [
                    { Metric: 'Current Monthly Cost', Value: safeFormat(calculations.currentMonthlyCost) },
                    { Metric: 'Platform Monthly Cost', Value: safeFormat(calculations.platformMonthlyCost) },
                    { Metric: 'Monthly Savings', Value: safeFormat(calculations.currentMonthlyCost - calculations.platformMonthlyCost) },
                    { Metric: 'Break-even Point (months)', Value: safeFormat(calculations.breakEvenMonths) },
                    { Metric: '3-Year Total Savings', Value: safeFormat(calculations.threeYearSavings) },
                    { Metric: 'ROI Percentage', Value: safeFormat(calculations.savingsPercent) },
                    { Metric: 'Platform Development Cost', Value: safeFormat(calculations.platformCost) },
                    { Metric: 'Monthly Maintenance Cost', Value: safeFormat(calculations.platformMaintenanceCost) }
                ];
                
                // Create risk analysis worksheet
                const riskData = [
                    { Scenario: 'Optimistic', Savings: safeFormat(calculations.optimisticSavings) },
                    { Scenario: 'Expected', Savings: safeFormat(calculations.threeYearSavings) },
                    { Scenario: 'Pessimistic', Savings: safeFormat(calculations.pessimisticSavings) }
                ];
                
                // Add worksheets to workbook
                const ws = XLSX.utils.json_to_sheet(monthlyData);
                const wsSummary = XLSX.utils.json_to_sheet(summaryData);
                const wsRisk = XLSX.utils.json_to_sheet(riskData);
                
                // Add column widths
                ws['!cols'] = [
                    { wch: 10 }, // Month
                    { wch: 15 }, // Current Cost
                    { wch: 15 }, // Platform Cost
                    { wch: 15 }, // Monthly Savings
                    { wch: 15 }  // Cumulative Savings
                ];
                
                XLSX.utils.book_append_sheet(wb, wsSummary, 'Summary');
                XLSX.utils.book_append_sheet(wb, ws, 'Monthly Data');
                XLSX.utils.book_append_sheet(wb, wsRisk, 'Risk Analysis');
                
                // Save the file
                XLSX.writeFile(wb, 'investment-analysis.xlsx');
            };

            React.useEffect(() => {
                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }

                const ctx = chartRef.current.getContext('2d');
                let chartConfig;

                const commonOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            titleColor: '#1F2937',
                            bodyColor: '#1F2937',
                            borderColor: '#E5E7EB',
                            borderWidth: 1,
                            padding: 12,
                            boxPadding: 6,
                            usePointStyle: true,
                            callbacks: {
                                label: (context) => `$${context.raw.toLocaleString()}`
                            }
                        }
                    }
                };

                switch (activeChart) {
                    case 'monthly':
                        chartConfig = {
                            type: 'bar',
                            data: {
                                labels: calculations.months,
                                datasets: [
                                    {
                                        label: 'Current Monthly Cost',
                                        data: calculations.months.map(() => calculations.currentMonthlyCost),
                                        backgroundColor: 'rgba(79, 70, 229, 0.8)',
                                        borderRadius: 4,
                                        order: 2
                                    },
                                    {
                                        label: 'Platform Monthly Cost',
                                        data: calculations.months.map((_, i) => 
                                            i < calculations.buildTime ? 
                                            calculations.platformCosts[i] / calculations.buildTime :
                                            calculations.platformMonthlyCost
                                        ),
                                        backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                        borderRadius: 4,
                                        order: 2
                                    },
                                    {
                                        label: 'Monthly Savings',
                                        data: calculations.months.map((_, i) => 
                                            calculations.currentMonthlyCost - 
                                            (i < calculations.buildTime ? 
                                                calculations.platformCosts[i] / calculations.buildTime :
                                                calculations.platformMonthlyCost)
                                        ),
                                        type: 'line',
                                        borderColor: 'rgba(245, 158, 11, 1)',
                                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 2,
                                        pointHoverRadius: 4,
                                        order: 1
                                    }
                                ]
                            },
                            options: {
                                ...commonOptions,
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        grid: {
                                            color: 'rgba(0, 0, 0, 0.05)'
                                        },
                                        ticks: {
                                            callback: (value) => `$${value.toLocaleString()}`
                                        }
                                    },
                                    x: {
                                        grid: {
                                            display: false
                                        }
                                    }
                                }
                            }
                        };
                        break;

                    case 'breakdown':
                        const totalCost = calculations.platformCost + 
                            (calculations.platformMaintenanceCost * 36) + 
                            (calculations.platformMonthlyCost * 36);
                        
                        chartConfig = {
                            type: 'doughnut',
                            data: {
                                labels: [
                                    'Initial Development',
                                    'Ongoing Maintenance',
                                    'Operational Costs',
                                    'Projected Savings'
                                ],
                                datasets: [{
                                    data: [
                                        calculations.platformCost,
                                        calculations.platformMaintenanceCost * 36,
                                        calculations.platformMonthlyCost * 36,
                                        calculations.threeYearSavings
                                    ],
                                    backgroundColor: [
                                        'rgba(79, 70, 229, 0.8)',
                                        'rgba(16, 185, 129, 0.8)',
                                        'rgba(245, 158, 11, 0.8)',
                                        'rgba(6, 182, 212, 0.8)'
                                    ],
                                    borderWidth: 2,
                                    borderColor: '#ffffff'
                                }]
                            },
                            options: {
                                ...commonOptions,
                                cutout: '60%',
                                plugins: {
                                    ...commonOptions.plugins,
                                    tooltip: {
                                        ...commonOptions.plugins.tooltip,
                                        callbacks: {
                                            label: (context) => {
                                                const value = context.raw;
                                                const percentage = ((value / totalCost) * 100).toFixed(1);
                                                return `${context.label}: $${value.toLocaleString()} (${percentage}%)`;
                                            }
                                        }
                                    },
                                    doughnutlabel: {
                                        labels: [{
                                            text: 'Total Cost',
                                            font: {
                                                size: '16'
                                            }
                                        }, {
                                            text: `$${totalCost.toLocaleString()}`,
                                            font: {
                                                size: '20',
                                                weight: 'bold'
                                            }
                                        }]
                                    }
                                }
                            }
                        };
                        break;

                    case 'savings':
                        const monthlySavings = calculations.months.map((_, i) => 
                            calculations.currentCosts[i] - calculations.platformCosts[i]
                        );
                        const cumulativeSavings = monthlySavings.reduce((acc, curr, i) => {
                            acc.push((acc[i-1] || 0) + curr);
                            return acc;
                        }, []);
                        
                        chartConfig = {
                            type: 'line',
                            data: {
                                labels: calculations.months,
                                datasets: [
                                    {
                                        label: 'Monthly Savings',
                                        data: monthlySavings,
                                        borderColor: 'rgba(16, 185, 129, 1)',
                                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 2,
                                        pointHoverRadius: 4,
                                        yAxisID: 'y'
                                    },
                                    {
                                        label: 'Cumulative Savings',
                                        data: cumulativeSavings,
                                        borderColor: 'rgba(79, 70, 229, 1)',
                                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 2,
                                        pointHoverRadius: 4,
                                        yAxisID: 'y1'
                                    },
                                    {
                                        label: 'Break-even Threshold',
                                        data: calculations.months.map(() => calculations.platformCost),
                                        borderColor: 'rgba(245, 158, 11, 1)',
                                        borderDash: [6, 6],
                                        fill: false,
                                        pointRadius: 0,
                                        yAxisID: 'y1'
                                    }
                                ]
                            },
                            options: {
                                ...commonOptions,
                                scales: {
                                    y: {
                                        position: 'left',
                                        grid: {
                                            color: 'rgba(0, 0, 0, 0.05)'
                                        },
                                        ticks: {
                                            callback: (value) => `$${value.toLocaleString()}`
                                        },
                                        title: {
                                            display: true,
                                            text: 'Monthly Savings'
                                        }
                                    },
                                    y1: {
                                        position: 'right',
                                        grid: {
                                            display: false
                                        },
                                        ticks: {
                                            callback: (value) => `$${value.toLocaleString()}`
                                        },
                                        title: {
                                            display: true,
                                            text: 'Cumulative Savings'
                                        }
                                    },
                                    x: {
                                        grid: {
                                            display: false
                                        }
                                    }
                                }
                            }
                        };
                        break;

                    default: // cumulative
                        chartConfig = {
                            type: 'line',
                            data: {
                                labels: calculations.months,
                                datasets: [
                                    {
                                        label: 'Current Approach',
                                        data: calculations.currentCosts,
                                        borderColor: 'rgba(79, 70, 229, 1)',
                                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 2,
                                        pointHoverRadius: 4
                                    },
                                    {
                                        label: 'Platform Approach',
                                        data: calculations.platformCosts,
                                        borderColor: 'rgba(16, 185, 129, 1)',
                                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                        fill: true,
                                        tension: 0.4,
                                        pointRadius: 2,
                                        pointHoverRadius: 4
                                    }
                                ]
                            },
                            options: {
                                ...commonOptions,
                                scales: {
                                    y: {
                                        grid: {
                                            color: 'rgba(0, 0, 0, 0.05)'
                                        },
                                        ticks: {
                                            callback: (value) => `$${value.toLocaleString()}`
                                        }
                                    },
                                    x: {
                                        grid: {
                                            display: false
                                        }
                                    }
                                },
                                plugins: {
                                    ...commonOptions.plugins,
                                    annotation: {
                                        annotations: {
                                            breakeven: {
                                                type: 'line',
                                                xMin: calculations.breakEvenMonths,
                                                xMax: calculations.breakEvenMonths,
                                                borderColor: 'rgba(245, 158, 11, 0.5)',
                                                borderWidth: 2,
                                                borderDash: [6, 6],
                                                label: {
                                                    content: 'Break-even Point',
                                                    enabled: true,
                                                    position: 'top'
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        };
                }

                chartInstance.current = new Chart(ctx, chartConfig);

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [calculations, activeChart]);

            return (
                <div className="space-y-8">
                    <ExportButtons 
                        onExportPDF={handleExportPDF}
                        onExportExcel={handleExportExcel}
                    />
                    
                    {/* Key Metrics Cards */}
                    <div className="grid grid-cols-2 lg:grid-cols-4 gap-6">
                        <MetricCard
                            title="Current Monthly Cost"
                            value={calculations.currentMonthlyCost}
                            color="indigo"
                        />
                        <MetricCard
                            title="Platform Monthly Cost"
                            value={calculations.platformMonthlyCost}
                            color="emerald"
                        />
                        <MetricCard
                            title="Break-even Point"
                            value={`${calculations.breakEvenMonths} months`}
                            color={calculations.breakEvenMonths <= 12 ? 'emerald' : 'amber'}
                        />
                        <MetricCard
                            title="3-Year Savings"
                            value={calculations.threeYearSavings}
                            trend={`${calculations.savingsPercent}%`}
                            color="indigo"
                        />
                    </div>

                    {/* Analysis Views */}
                    <div className="bg-white rounded-xl shadow-lg p-8">
                        <h3 className="text-xl font-semibold text-gray-900 mb-6">Analysis Views</h3>
                        <div className="grid grid-cols-2 lg:grid-cols-4 gap-6">
                            {[
                                { 
                                    id: 'cumulative', 
                                    label: 'Total Cost Over Time',
                                    description: 'Compare cumulative costs between approaches',
                                    icon: (
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                                        </svg>
                                    )
                                },
                                { 
                                    id: 'monthly', 
                                    label: 'Monthly Expenses',
                                    description: 'View month-by-month cost comparison',
                                    icon: (
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                        </svg>
                                    )
                                },
                                { 
                                    id: 'breakdown', 
                                    label: 'Cost Distribution',
                                    description: 'See how costs are distributed',
                                    icon: (
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
                                        </svg>
                                    )
                                },
                                { 
                                    id: 'savings', 
                                    label: 'Savings Analysis',
                                    description: 'Track potential savings over time',
                                    icon: (
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    )
                                }
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveChart(tab.id)}
                                    className={`p-6 rounded-xl text-left transition-all duration-200 ${
                                        activeChart === tab.id 
                                        ? 'bg-indigo-600 text-white transform scale-105 shadow-lg' 
                                        : 'bg-gray-50 text-gray-700 hover:bg-gray-100'
                                    }`}
                                >
                                    <div className={`w-12 h-12 rounded-lg flex items-center justify-center mb-4 ${
                                        activeChart === tab.id ? 'bg-indigo-500' : 'bg-white'
                                    }`}>
                                        {tab.icon}
                                    </div>
                                    <div className="font-medium text-lg mb-2">{tab.label}</div>
                                    <div className={`text-sm ${
                                        activeChart === tab.id ? 'text-indigo-100' : 'text-gray-500'
                                    }`}>
                                        {tab.description}
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Chart Container */}
                    <div className="bg-white rounded-xl shadow-lg p-8">
                        <div className="h-[500px]">
                            <canvas ref={chartRef}></canvas>
                        </div>
                    </div>

                    {/* Cost Comparison Table */}
                    <div className="bg-white rounded-xl shadow-lg p-8">
                        <h3 className="text-xl font-semibold text-gray-900 mb-6">Detailed Cost Comparison</h3>
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Time Period
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Current Approach
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Platform Approach
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Potential Savings
                                        </th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                            Monthly
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${calculations.currentMonthlyCost.toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${calculations.platformMonthlyCost.toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                            <span className={`px-2 py-1 rounded-full ${
                                                calculations.platformMonthlyCost < calculations.currentMonthlyCost 
                                                ? 'bg-emerald-100 text-emerald-800' 
                                                : 'bg-red-100 text-red-800'
                                            }`}>
                                                ${Math.abs(calculations.currentMonthlyCost - calculations.platformMonthlyCost).toLocaleString()}
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                            First Year
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${(calculations.currentMonthlyCost * 12).toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${(calculations.platformMonthlyCost * 12).toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                            <span className={`px-2 py-1 rounded-full ${
                                                calculations.platformMonthlyCost < calculations.currentMonthlyCost 
                                                ? 'bg-emerald-100 text-emerald-800' 
                                                : 'bg-red-100 text-red-800'
                                            }`}>
                                                ${Math.abs(calculations.currentMonthlyCost * 12 - calculations.platformMonthlyCost * 12).toLocaleString()}
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                            Three Years
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${calculations.currentCosts[35].toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            ${calculations.platformCosts[35].toLocaleString()}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                            <span className="px-2 py-1 rounded-full bg-emerald-100 text-emerald-800">
                                                ${calculations.threeYearSavings.toLocaleString()}
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {/* Sensitivity Analysis */}
                    {calculations.optimisticSavings && (
                        <div className="bg-white rounded-xl shadow-lg p-8">
                            <h3 className="text-xl font-semibold text-gray-900 mb-6">Sensitivity Analysis</h3>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                                <div className="p-6 bg-amber-50 rounded-xl border border-amber-200">
                                    <div className="flex items-center gap-4 mb-4">
                                        <div className="p-3 bg-amber-100 rounded-lg">
                                            <svg className="w-8 h-8 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                    d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 className="text-lg font-medium text-amber-900">Pessimistic</h4>
                                            <p className="text-sm text-amber-700">10% Higher Costs</p>
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        <p className="text-3xl font-bold text-amber-900">
                                            ${Math.abs(calculations.pessimisticSavings).toLocaleString()}
                                        </p>
                                        <p className="text-sm text-amber-700">
                                            {calculations.pessimisticSavings >= 0 ? 'Potential Savings' : 'Additional Cost'}
                                        </p>
                                    </div>
                                </div>
                                <div className="p-6 bg-indigo-50 rounded-xl border border-indigo-200">
                                    <div className="flex items-center gap-4 mb-4">
                                        <div className="p-3 bg-indigo-100 rounded-lg">
                                            <svg className="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 className="text-lg font-medium text-indigo-900">Expected</h4>
                                            <p className="text-sm text-indigo-700">Base Scenario</p>
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        <p className="text-3xl font-bold text-indigo-900">
                                            ${Math.abs(calculations.threeYearSavings).toLocaleString()}
                                        </p>
                                        <p className="text-sm text-indigo-700">
                                            Projected Savings
                                        </p>
                                    </div>
                                </div>
                                <div className="p-6 bg-emerald-50 rounded-xl border border-emerald-200">
                                    <div className="flex items-center gap-4 mb-4">
                                        <div className="p-3 bg-emerald-100 rounded-lg">
                                            <svg className="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                                    d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                                            </svg>
                                        </div>
                                        <div>
                                            <h4 className="text-lg font-medium text-emerald-900">Optimistic</h4>
                                            <p className="text-sm text-emerald-700">10% Lower Costs</p>
                                        </div>
                                    </div>
                                    <div className="space-y-2">
                                        <p className="text-3xl font-bold text-emerald-900">
                                            ${Math.abs(calculations.optimisticSavings).toLocaleString()}
                                        </p>
                                        <p className="text-sm text-emerald-700">
                                            Maximum Potential Savings
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const LandingContent = () => (
            <div className="space-y-12">
                {/* Hero Section */}
                <div className="text-center">
                    <h1 className="text-5xl font-bold text-gray-900 mb-6">
                        Service Delivery Cost Analysis
                    </h1>
                    <p className="text-xl text-gray-600 max-w-3xl mx-auto">
                        A comprehensive tool for analyzing the financial implications of service delivery models:
                        manual operations, platform automation, and strategic outsourcing.
                    </p>
                </div>

                {/* Models Explanation */}
                <div className="bg-white rounded-xl shadow-lg p-8">
                    <h2 className="text-2xl font-bold text-gray-900 mb-6">Analysis Models</h2>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div className="space-y-4">
                            <div className="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center mb-4">
                                <svg className="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                            <h3 className="text-lg font-semibold text-gray-900">Team-Based Model</h3>
                            <div className="text-gray-600 space-y-2">
                                <p>Calculates costs based on:</p>
                                <ul className="list-disc pl-5 space-y-1">
                                    <li>Team size (FTEs)</li>
                                    <li>Hourly rates</li>
                                    <li>Service delivery time</li>
                                    <li>Overhead costs</li>
                                </ul>
                                <p className="text-sm text-gray-500 mt-2">
                                    Best for: Organizations with dedicated service teams and stable workloads
                                </p>
                            </div>
                        </div>
                        <div className="space-y-4">
                            <div className="w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center mb-4">
                                <svg className="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                                </svg>
                            </div>
                            <h3 className="text-lg font-semibold text-gray-900">Ticket-Based Model</h3>
                            <div className="text-gray-600 space-y-2">
                                <p>Analyzes costs based on:</p>
                                <ul className="list-disc pl-5 space-y-1">
                                    <li>Monthly ticket volume</li>
                                    <li>Hours per ticket</li>
                                    <li>Resource allocation</li>
                                    <li>Processing efficiency</li>
                                </ul>
                                <p className="text-sm text-gray-500 mt-2">
                                    Best for: Service desk operations and request-driven workflows
                                </p>
                            </div>
                        </div>
                        <div className="space-y-4">
                            <div className="w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center mb-4">
                                <svg className="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" 
                                        d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <h3 className="text-lg font-semibold text-gray-900">Outsourcing Model</h3>
                            <div className="text-gray-600 space-y-2">
                                <p>Evaluates costs considering:</p>
                                <ul className="list-disc pl-5 space-y-1">
                                    <li>Vendor rates</li>
                                    <li>Transition costs</li>
                                    <li>Management overhead</li>
                                    <li>Contract flexibility</li>
                                </ul>
                                <p className="text-sm text-gray-500 mt-2">
                                    Best for: Evaluating external service provider options
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Calculation Methods */}
                <div className="bg-white rounded-xl shadow-lg p-8">
                    <h2 className="text-2xl font-bold text-gray-900 mb-6">Calculation Methodology</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div className="space-y-4">
                            <h3 className="text-lg font-semibold text-gray-900">Cost Factors</h3>
                            <div className="space-y-3">
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-indigo-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Direct Costs</h4>
                                        <p className="text-sm text-gray-600">Labor, infrastructure, licenses, and operational expenses</p>
                                    </div>
                                </div>
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-indigo-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Indirect Costs</h4>
                                        <p className="text-sm text-gray-600">Management overhead, quality assurance, and support functions</p>
                                    </div>
                                </div>
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-indigo-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Risk Adjustments</h4>
                                        <p className="text-sm text-gray-600">Contingency buffers and uncertainty factors</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="space-y-4">
                            <h3 className="text-lg font-semibold text-gray-900">Analysis Methods</h3>
                            <div className="space-y-3">
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Time Value of Money</h4>
                                        <p className="text-sm text-gray-600">5% annual discount rate applied to future costs</p>
                                    </div>
                                </div>
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Sensitivity Analysis</h4>
                                        <p className="text-sm text-gray-600">10% variance scenarios for risk assessment</p>
                                    </div>
                                </div>
                                <div className="flex items-start">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                    </svg>
                                    <div>
                                        <h4 className="font-medium text-gray-900">Quality Impact</h4>
                                        <p className="text-sm text-gray-600">5% value adjustment for quality improvements</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {/* Analysis Features */}
                <div className="bg-white rounded-xl shadow-lg p-8">
                    <h2 className="text-2xl font-bold text-gray-900 mb-6">Analysis Features</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div className="space-y-2">
                            <h3 className="text-lg font-semibold text-gray-900">Cost Analysis</h3>
                            <ul className="space-y-2 text-gray-600">
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Monthly cost tracking
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Cumulative cost comparison
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Break-even analysis
                                </li>
                            </ul>
                        </div>
                        <div className="space-y-2">
                            <h3 className="text-lg font-semibold text-gray-900">Visualizations</h3>
                            <ul className="space-y-2 text-gray-600">
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Interactive charts
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Cost breakdown diagrams
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Trend analysis
                                </li>
                            </ul>
                        </div>
                        <div className="space-y-2">
                            <h3 className="text-lg font-semibold text-gray-900">Reporting</h3>
                            <ul className="space-y-2 text-gray-600">
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    PDF export
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Excel data export
                                </li>
                                <li className="flex items-center">
                                    <svg className="w-5 h-5 text-emerald-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    Executive summaries
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                {/* CTA */}
                <div className="text-center">
                    <button 
                        onClick={() => setActiveTab('calculator')}
                        className="px-8 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 
                                 transition-colors duration-200 shadow-lg hover:shadow-xl"
                    >
                        Start Analysis
                    </button>
                </div>
            </div>
        );

        function App() {
            const [activeTab, setActiveTab] = React.useState('landing');
            const [activeModel, setActiveModel] = React.useState('team');
            const [showAdvanced, setShowAdvanced] = React.useState(false);
            
            // Team Model State
            const [teamInputs, setTeamInputs] = React.useState({
                teamSize: 10,
                hourlyRate: 100,
                serviceDeliveryPercent: 30,
                platformCost: 200000,
                platformMaintenanceCost: 5000,
                expectedReduction: 50,
                buildTime: 6
            });

            // Ticket Model State
            const [ticketInputs, setTicketInputs] = React.useState({
                ticketsPerMonth: 20,
                hoursPerTicket: 4,
                peoplePerTicket: 1,
                hourlyRate: 100,
                platformCost: 200000,
                platformMaintenanceCost: 5000,
                expectedReduction: 50,
                buildTime: 6
            });

            // Outsourcing Model State
            const [outsourceInputs, setOutsourceInputs] = React.useState({
                vendorRate: 75,
                monthlyHours: 160,
                transitionCost: 50000,
                managementOverhead: 15,
                contractLength: 12
            });

            // Input Change Handlers
            const handleTeamInputChange = (e) => {
                const { name, value } = e.target;
                setTeamInputs(prev => ({
                    ...prev,
                    [name]: Number(value)
                }));
            };

            const handleTicketInputChange = (e) => {
                const { name, value } = e.target;
                setTicketInputs(prev => ({
                    ...prev,
                    [name]: Number(value)
                }));
            };

            const handleOutsourceInputChange = (e) => {
                const { name, value } = e.target;
                setOutsourceInputs(prev => ({
                    ...prev,
                    [name]: Number(value)
                }));
            };

            // Render Input Fields Based on Active Model
            const renderInputs = () => {
                switch (activeModel) {
                    case 'team':
                        return <TeamInputs inputs={teamInputs} handleInputChange={handleTeamInputChange} />;
                    case 'ticket':
                        return <TicketInputs inputs={ticketInputs} handleInputChange={handleTicketInputChange} />;
                    case 'outsource':
                        return <OutsourceInputs inputs={outsourceInputs} handleInputChange={handleOutsourceInputChange} />;
                    default:
                        return null;
                }
            };

            React.useEffect(() => {
                // Initialize tooltips
                tippy('[data-tippy-content]', {
                    placement: 'right',
                    arrow: true,
                    theme: 'light'
                });
            }, [activeModel]);

            // Calculation Functions
            const calculateTeamCosts = (inputs) => {
                // Base calculations
                const currentMonthlyCost = inputs.teamSize * inputs.hourlyRate * 
                    MONTHLY_WORKING_HOURS * (inputs.serviceDeliveryPercent / 100);
                
                // Add risk adjustment (10% buffer)
                const riskAdjustedMonthlyCost = currentMonthlyCost * 1.1;
                
                // Platform costs with maintenance and risk buffer
                const platformMonthlyCost = (currentMonthlyCost * (1 - inputs.expectedReduction / 100) + 
                    inputs.platformMaintenanceCost) * 1.15; // 15% risk buffer for platform
                
                const months = Array.from({ length: 36 }, (_, i) => i + 1);
                
                // Time value of money adjustment (5% annual discount rate)
                const annualDiscountRate = 0.05;
                const monthlyDiscountRate = annualDiscountRate / 12;
                
                const currentCosts = months.map(month => {
                    const discountFactor = 1 / Math.pow(1 + monthlyDiscountRate, month);
                    return riskAdjustedMonthlyCost * month * discountFactor;
                });
                
                const platformCosts = months.map(month => {
                    const discountFactor = 1 / Math.pow(1 + monthlyDiscountRate, month);
                    if (month <= inputs.buildTime) {
                        return (inputs.platformCost / inputs.buildTime) * month * discountFactor;
                    }
                    return (inputs.platformCost + platformMonthlyCost * (month - inputs.buildTime)) * discountFactor;
                });

                // Quality impact estimation (reduced errors, faster delivery)
                const qualityImprovementValue = currentMonthlyCost * 0.05; // 5% value add from quality
                const adjustedPlatformCosts = platformCosts.map(cost => cost - qualityImprovementValue);

                // Sensitivity analysis
                const optimisticSavings = currentCosts[35] - (platformCosts[35] * 0.9); // 10% better
                const pessimisticSavings = currentCosts[35] - (platformCosts[35] * 1.1); // 10% worse

                const breakEvenMonths = (() => {
                    const index = adjustedPlatformCosts.findIndex((cost, index) => 
                        currentCosts[index] >= cost && index > inputs.buildTime);
                    
                    if (index === -1) {
                        return 'Not within 3 years';
                    }
                    
                    // If break-even occurs during build time, return build time
                    if (index <= inputs.buildTime) {
                        return inputs.buildTime;
                    }
                    
                    return index;
                })();

                const threeYearSavings = currentCosts[35] - adjustedPlatformCosts[35];
                const savingsPercent = Math.round((threeYearSavings / currentCosts[35]) * 100);

                return {
                    currentMonthlyCost: riskAdjustedMonthlyCost,
                    platformMonthlyCost,
                    months,
                    currentCosts,
                    platformCosts: adjustedPlatformCosts,
                    breakEvenMonths,
                    threeYearSavings,
                    savingsPercent,
                    optimisticSavings,
                    pessimisticSavings,
                    qualityImprovementValue,
                    riskAdjustment: {
                        operational: 10,
                        platform: 15
                    }
                };
            };

            const calculateTicketCosts = (inputs) => {
                const currentMonthlyCost = inputs.ticketsPerMonth * inputs.hoursPerTicket * 
                    inputs.peoplePerTicket * inputs.hourlyRate;
                
                const platformMonthlyCost = currentMonthlyCost * (1 - inputs.expectedReduction / 100) + 
                    inputs.platformMaintenanceCost;
                
                // Rest of calculation similar to team costs
                const months = Array.from({ length: 36 }, (_, i) => i + 1);
                const currentCosts = months.map(month => currentMonthlyCost * month);
                
                const platformCosts = months.map(month => {
                    if (month <= inputs.buildTime) {
                        return (inputs.platformCost / inputs.buildTime) * month;
                    }
                    return (inputs.platformCost) + (platformMonthlyCost * (month - inputs.buildTime));
                });

                const breakEvenMonths = platformCosts.findIndex((cost, index) => 
                    currentCosts[index] >= cost && index > inputs.buildTime) || 36;

                const threeYearSavings = currentCosts[35] - platformCosts[35];
                const savingsPercent = Math.round((threeYearSavings / currentCosts[35]) * 100);

                return {
                    currentMonthlyCost,
                    platformMonthlyCost,
                    months,
                    currentCosts,
                    platformCosts,
                    breakEvenMonths,
                    threeYearSavings,
                    savingsPercent
                };
            };

            const calculateOutsourceCosts = (inputs) => {
                const currentMonthlyCost = inputs.monthlyHours * inputs.vendorRate;
                const managementCost = currentMonthlyCost * (inputs.managementOverhead / 100);
                const totalMonthlyCost = currentMonthlyCost + managementCost;
                
                const months = Array.from({ length: 36 }, (_, i) => i + 1);
                const costs = months.map(month => {
                    return inputs.transitionCost + (totalMonthlyCost * month);
                });

                return {
                    currentMonthlyCost: totalMonthlyCost,
                    platformMonthlyCost: 0,
                    months,
                    currentCosts: costs,
                    platformCosts: costs,
                    breakEvenMonths: 0,
                    threeYearSavings: 0,
                    savingsPercent: 0
                };
            };

            // Get current calculations based on active model
            const getCurrentCalculations = () => {
                switch (activeModel) {
                    case 'team':
                        return calculateTeamCosts(teamInputs);
                    case 'ticket':
                        return calculateTicketCosts(ticketInputs);
                    case 'outsource':
                        return calculateOutsourceCosts(outsourceInputs);
                    default:
                        return null;
                }
            };

            const calculations = getCurrentCalculations();

            return (
                <div className="max-w-7xl mx-auto px-4 py-8">
                    {/* Navigation */}
                    <nav className="flex justify-center mb-12">
                        <div className="flex gap-4">
                            <button
                                onClick={() => setActiveTab('landing')}
                                className={`px-6 py-2 rounded-lg font-medium transition-all duration-200
                                    ${activeTab === 'landing' 
                                        ? 'bg-indigo-600 text-white shadow-lg' 
                                        : 'bg-white text-gray-700 hover:bg-gray-50'}`}
                            >
                                Overview
                            </button>
                            <button
                                onClick={() => setActiveTab('calculator')}
                                className={`px-6 py-2 rounded-lg font-medium transition-all duration-200
                                    ${activeTab === 'calculator' 
                                        ? 'bg-indigo-600 text-white shadow-lg' 
                                        : 'bg-white text-gray-700 hover:bg-gray-50'}`}
                            >
                                Calculator
                            </button>
                        </div>
                    </nav>

                    {activeTab === 'landing' ? (
                        <LandingContent />
                    ) : (
                        <>
                            {/* Calculator Content */}
                            <div className="text-center mb-12">
                                <h1 className="text-4xl font-bold text-gray-900 mb-4">
                                    Service Platform Investment Calculator
                                </h1>
                                <p className="text-xl text-gray-600 max-w-3xl mx-auto">
                                    Make data-driven decisions about transforming your service delivery team 
                                    into a platform-based solution or outsourcing strategy.
                                </p>
                            </div>

                            <ModelSelector activeModel={activeModel} setActiveModel={setActiveModel} />

                            <div className="space-y-8">
                                {/* Inputs Section */}
                                <div className="bg-white rounded-xl shadow-lg p-8">
                                    <h2 className="text-xl font-semibold text-gray-900 mb-6">
                                        Input Parameters
                                    </h2>
                                    {renderInputs()}
                                    {activeModel !== 'outsource' && (
                                        <PlatformInputs 
                                            inputs={activeModel === 'team' ? teamInputs : ticketInputs}
                                            handleInputChange={activeModel === 'team' ? handleTeamInputChange : handleTicketInputChange}
                                        />
                                    )}
                                </div>

                                {/* Analysis Results Section - Now Full Width */}
                                <div className="bg-white rounded-xl shadow-lg p-8">
                                    <h2 className="text-xl font-semibold text-gray-900 mb-6">
                                        Analysis Results
                                    </h2>
                                    <AnalysisResults 
                                        activeModel={activeModel}
                                        calculations={calculations || {
                                            currentMonthlyCost: 0,
                                            platformMonthlyCost: 0,
                                            breakEvenMonths: 0,
                                            threeYearSavings: 0,
                                            savingsPercent: 0,
                                            currentCosts: [0],
                                            platformCosts: [0],
                                            months: [],
                                            optimisticSavings: 0,
                                            pessimisticSavings: 0,
                                            platformCost: 0,
                                            platformMaintenanceCost: 0
                                        }}
                                    />
                                </div>
                            </div>
                        </>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>

    <footer class="text-center py-4 text-gray-600">
         2024 viktorcessan.com - All rights reserved
    </footer>
</body>
</html> 